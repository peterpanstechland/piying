<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å€’è®¡æ—¶æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #000;
            color: #fff;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #ffd700;
        }
        .test-section {
            background: #222;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .countdown-display {
            font-size: 72px;
            font-weight: bold;
            color: #ffd700;
            text-align: center;
            margin: 20px 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.idle {
            background: #444;
        }
        .status.counting {
            background: #ff6600;
        }
        .status.complete {
            background: #00ff00;
            color: #000;
        }
        button {
            background: #ffd700;
            color: #000;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #ffed4e;
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        .log {
            background: #111;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            margin: 2px 0;
        }
        .log-entry.info {
            color: #00ff00;
        }
        .log-entry.warn {
            color: #ffaa00;
        }
        .log-entry.error {
            color: #ff0000;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ­ å€’è®¡æ—¶åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>æµ‹è¯•è¯´æ˜</h2>
            <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•å€’è®¡æ—¶é€»è¾‘æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
            <p>ç‚¹å‡»"å¼€å§‹å€’è®¡æ—¶"æŒ‰é’®ï¼Œè§‚å¯Ÿå€’è®¡æ—¶æ˜¯å¦ä»æŒ‡å®šæ•°å­—é€’å‡åˆ°0ã€‚</p>
        </div>

        <div class="test-section">
            <h2>å€’è®¡æ—¶æ˜¾ç¤º</h2>
            <div class="countdown-display" id="countdownDisplay">--</div>
            <div class="status idle" id="status">çŠ¶æ€ï¼šç­‰å¾…å¼€å§‹</div>
        </div>

        <div class="test-section">
            <h2>æ§åˆ¶</h2>
            <button onclick="startCountdown(5)">5ç§’å€’è®¡æ—¶</button>
            <button onclick="startCountdown(3)">3ç§’å€’è®¡æ—¶</button>
            <button onclick="startCountdown(10)">10ç§’å€’è®¡æ—¶</button>
            <button onclick="resetTest()">é‡ç½®</button>
        </div>

        <div class="test-section">
            <h2>æ—¥å¿—</h2>
            <div class="log" id="log"></div>
        </div>
    </div>

    <script>
        let intervalId = null;
        let countdown = 0;
        let completed = false;

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function updateDisplay(value) {
            const display = document.getElementById('countdownDisplay');
            if (value === 0) {
                display.textContent = 'å¼€å§‹ï¼';
                display.style.color = '#00ff00';
            } else {
                display.textContent = value;
                display.style.color = '#ffd700';
            }
        }

        function updateStatus(text, className) {
            const status = document.getElementById('status');
            status.textContent = `çŠ¶æ€ï¼š${text}`;
            status.className = `status ${className}`;
        }

        function startCountdown(duration) {
            log(`å¼€å§‹ ${duration} ç§’å€’è®¡æ—¶`, 'info');
            
            // æ¸…ç†ç°æœ‰å®šæ—¶å™¨
            if (intervalId !== null) {
                log('æ¸…ç†ç°æœ‰å®šæ—¶å™¨', 'warn');
                clearInterval(intervalId);
                intervalId = null;
            }

            // é‡ç½®çŠ¶æ€
            countdown = duration;
            completed = false;
            updateDisplay(countdown);
            updateStatus('å€’è®¡æ—¶ä¸­...', 'counting');

            // å¯åŠ¨å®šæ—¶å™¨
            intervalId = setInterval(() => {
                log(`å€’è®¡æ—¶ tick: ${countdown}`, 'info');
                
                if (countdown <= 1) {
                    // æ¸…ç†å®šæ—¶å™¨
                    clearInterval(intervalId);
                    intervalId = null;
                    
                    // è§¦å‘å®Œæˆ
                    if (!completed) {
                        completed = true;
                        log('å€’è®¡æ—¶å®Œæˆï¼', 'info');
                        updateDisplay(0);
                        updateStatus('å®Œæˆï¼', 'complete');
                        
                        // æ¨¡æ‹Ÿå›è°ƒå»¶è¿Ÿ
                        setTimeout(() => {
                            log('è§¦å‘å›è°ƒï¼ˆæ¨¡æ‹Ÿè¿›å…¥ä¸‹ä¸€çŠ¶æ€ï¼‰', 'info');
                        }, 100);
                    }
                    countdown = 0;
                } else {
                    countdown--;
                    updateDisplay(countdown);
                }
            }, 1000);
        }

        function resetTest() {
            log('é‡ç½®æµ‹è¯•', 'warn');
            
            if (intervalId !== null) {
                clearInterval(intervalId);
                intervalId = null;
            }
            
            countdown = 0;
            completed = false;
            updateDisplay('--');
            updateStatus('ç­‰å¾…å¼€å§‹', 'idle');
        }

        // åˆå§‹åŒ–
        log('æµ‹è¯•é¡µé¢å·²åŠ è½½', 'info');
        log('ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•å€’è®¡æ—¶åŠŸèƒ½', 'info');
    </script>
</body>
</html>
